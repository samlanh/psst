<?php 
$session_user=new Zend_Session_Namespace('authstu');
$username = $session_user->first_name;
$them_style =  $session_user->theme_style;
$user_id = $session_user->user_id;
$login_part = $this->baseUrl();
$session_t=new Zend_Session_Namespace('authteacher');
$teacher_id = $session_t->teacher_id;

	if(empty($user_id)){
		if(empty($teacher_id)){
			Application_Form_FrmMessage::redirectUrl('/');	
		}
	}
	$tr=Application_Form_FrmLanguages::getCurrentlanguage();
	$base_url = $this->baseUrl()."/";
	$request=Zend_Controller_Front::getInstance()->getRequest();
	$action=$request->getActionName();
	$controller=$request->getControllerName();
	$module=$request->getModuleName();
	
	$session_user=new Zend_Session_Namespace('authstu');
	$arr_module = $session_user->arr_acl;
	$user_id = $session_user->user_id;
	if(empty($user_id)){
		Application_Form_FrmMessage::redirectUrl("/");
	}
	if(empty($username)){
		$username =  $session_t->teacher_name;
	}
	    $class='soria';
	    $them_style='soria';
		$level=$session_user->level;
		if($level!=1 AND $module=='rsvacl'){
			Application_Form_FrmMessage::redirectUrl("/home");	
		}
    ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
	<link rel="stylesheet" href="<?php echo $base_url;?>/css/template.css"/>
	<link href="<?php echo $this->baseUrl()."/datatable/bootstrap.min.css"?>" media="screen" rel="stylesheet" type="text/css">
	<link rel="stylesheet" href="<?php echo $base_url;?>datatable/font-awesome-4.7.0/css/font-awesome.min.css"/>
	<link href="<?php echo $base_url;?>/cssmenu/template.css" media="screen" rel="stylesheet" type="text/css">
	
	
<?php //if($module!='home'){?>
	<link rel="stylesheet" type="text/css" href="<?php echo $base_url;?>/js/dojo-1.6.1/dijit/themes/soria/soria.css"/>
	<script src="<?php echo $this->baseUrl()."/contextMenu/1.11.3/"?>jquery.min.js"></script>
	<script src="<?php echo $base_url;?>/js/help.js"  type="text/javascript"></script>
	<script src="<?php echo $base_url;?>/js/pdbs_js.js"  type="text/javascript"></script>
	<script type="text/javascript" src="<?php echo $this->baseUrl();?>/webcam/webcamjs/webcam.js"></script>
	<script type="text/javascript" src="<?php echo $this->baseUrl();?>/webcam/webcamjs/webcam.min.js"></script>
	<!-- 
	<script type="text/javascript" src="<?php echo $this->baseUrl();?>/js/jquery.tablesorter.js"> </script>
	<script type="text/javascript" src="<?php echo $this->baseUrl();?>/js/jquery.tablesorter.pager.js"> </script>
	 -->
<?php //}?>
<?php if($module=='allreport' OR $action=='allreports' OR $action=='studentnearlyendservice' OR 
		$action=='studentpaymentlate' OR $controller=='allreports' OR $controller=='rptproductsold' OR
		$controller=='studentnearlyendservice' OR $controller=='studentpaymentlate' ){?>
	<script type="text/javascript" src="<?php echo $this->baseUrl();?>/tableexport/tableExport.js"></script>
	<script type="text/javascript" src="<?php echo $this->baseUrl();?>/tableexport/jquery.base64.js"></script>
	<script type="text/javascript" src="<?php echo $this->baseUrl();?>/tableexport/html2canvas.js"></script>
	<script type="text/javascript" src="<?php echo $this->baseUrl();?>/tableexport/jspdf/libs/sprintf.js"></script>
	<script type="text/javascript" src="<?php echo $this->baseUrl();?>/tableexport/jspdf/jspdf.js"></script>
	<script type="text/javascript" src="<?php echo $this->baseUrl();?>/tableexport/jspdf/libs/base64.js"></script> 
      <?php } ?>
      
      <?php if ($action=="index" OR $module=='report'){?>
	<link href="<?php echo $this->baseUrl()."/contextMenu/"?>jquery.contextMenu.css" rel="stylesheet" type="text/css" />
	<script src="<?php echo $this->baseUrl()."/contextMenu/"?>jquery.contextMenu.js" type="text/javascript"></script>
	<script src="<?php echo $this->baseUrl()."/contextMenu/"?>jquery.ui.position.min.js" type="text/javascript"></script>
	
	<link href="<?php echo $this->baseUrl()."/datatable/"?>datatables.min.css" rel="stylesheet" type="text/css" />
    <link href="<?php echo $this->baseUrl()."/datatable/"?>responsive.dataTables.min.css" rel="stylesheet" type="text/css" />
    <script src="<?php echo $this->baseUrl()."/datatable/"?>datatables.min.js" type="text/javascript"></script>
    <script src="<?php echo $this->baseUrl()."/datatable/"?>dataTables.responsive.min.js" type="text/javascript"></script>
    
      <script>
    $(document).ready(function() {
        $('#datatable-responsive').DataTable( {
        	responsive: true,
       	 "dom": '<"top"i>rt<"bottom"flp><"clear">',
        	searching: false,
        } );
    } );
    </script>
	<?php }?>	
      <?php if($module!='home' OR ( $module=="home" AND $controller!=="index")){?>
	<script src="<?php echo $base_url;?>js/dojo-1.6.1/dojo/dojo.js"  djConfig="isDebug: true,parseOnLoad: true"></script>
	<script>dojoConfig = {parseOnLoad: true}</script>
	    <script>
			require(["dijit/form/Form","dijit/form/FilteringSelect","dijit/form/Button","dijit/Dialog"]);
      </script>
	<?php }?>
	<script>
	dojo.require("dijit.form.DateTextBox");
	dojo.require("dijit.form.ValidationTextBox");
	dojo.require('dijit.form.Form');
	dojo.require('dijit.form.FilteringSelect');	
	dojo.require('dijit.form.Button');
	dojo.require('dijit.form.NumberTextBox');
	
	dojo.require("dijit.form.CheckBox");     
	dojo.require("dojo.number");
	////dojo.require('dojox.form.BusyButton');
	dojo.require("dijit.form.RadioButton");
	dojo.require("dijit.Dialog");
	
	dojo.require("dijit.layout.BorderContainer");
	dojo.require("dijit.layout.TabContainer");
	dojo.require("dijit.layout.AccordionContainer");
	dojo.require("dijit.layout.ContentPane");
	dojo.require("dojo.parser");
	</script>
	<link rel="shortcut icon" href="<?php echo $base_url;?>/images/icon.ico" type="image/x-icon"/>
	<link href="<?php echo $this->baseUrl()."/datatable/bootstrap-custome.css"?>" media="screen" rel="stylesheet" type="text/css">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">	
	<style type="text/css">
		*{ padding:0;margin:0;}
        html, body { width: 100%; height: 100%; margin: 0;font-family: Arial,Helvetica,sans-serif,'Kh Battambang','Khmer Battambang'; }
		.btn{
			height: 40px;
			min-width: 100px;	
		}
		#menu ul {
		    margin: 0;
		}
		.fullside{ width:98%; height: 30px;}
		.full{ width:100%;}
		body, html {font-size:96%; 
		font-family: Arial,Helvetica,sans-serif,'Kh Battambang','Khmer Battambang';
		.normal,.alternate{ font-size:90% !important;}
		*{ padding: 0; margin: 0;}
		fieldset{ font-family: inherit;}
		.border{ border: 1px solid #ccc; height: 100%; margin: 5px; padding: 5px;}
        .border1{ border: 1px solid #ccc; height: 100%; margin: 5px; margin-left:0px; padding: 5px;}
		span.icon_menu {
		    padding: 0 5px;
		    font-size: 28px;
		}
		.mainblog{background: #b0ccff;
		    border-radius: 2px;
		    padding: 5px;
		    border: 1px solid #2761ca;
		 }
		table#datatable-responsive tr td a {
		    color: #337ab7;
		}
		#menu a {
		    -webkit-box-sizing: content-box;
		    -moz-box-sizing: content-box;
		    box-sizing: content-box;
		}
		ul li {
		    list-style-type: none;
		}
	</style>	
</head>
    <body class="<?php echo $class;?>" ><!-- oncontextmenu="return false;" -->
        <table style="height: 100%;" width="100%" >
            <tr height="45px" >
            	<td colspan="2" valign="top" style="position: fixed;width: 100%; z-index: 1;top: 0;"> <?php echo $this->render('header.phtml')?>
					<p style="font-size:13px !important;background: #fff;margin: 0;box-shadow: 1px 1px 1px #eee;">
				                <span style="padding-left: 3px;padding-right: 3px; display: inline-block; font-weight:600;"> <i class="fa fa-user" aria-hidden="true" style="line-height: 25px; font-size: 22px; color: #0f2a5b;"></i></span>
							    <span style="padding-left: 3px;padding-right: 3px; display: inline-block; font-weight:600;"> <?php //echo $tr->translate("USING_BY");?><a title="<?php echo $tr->translate("CHANGEPASSWORD");?>" style="color: #000098; text-transform: capitalize; font-size: 14px;" href="<?php echo $this->url(array('module'=>'','controller'=>'index','action'=>'changepassword')); ?>"><?php echo $username;?></a></span>  
								<span style="padding-left: 3px;padding-right: 3px; display: inline-block; font-weight:600;"> <a title="<?php echo $tr->translate("SIGN_OUT");?>" href="<?php echo $this->url(array('module'=>'','controller'=>'index','action'=>'logout','value'=>'1')); ?>" style="color: #000098; text-transform: capitalize;"> | <?php echo $tr->translate("SIGN_OUT");?></a></span>
				                <?php if($module!='home'){?>
				                <span style="padding-left: 3px;padding-right: 3px; display: inline-block; font-weight:600;"> <i class="fa fa-calculator" title="<?php echo $tr->translate("CALCULATOR");?>" aria-hidden="true" style="cursor:pointer; line-height: 25px; font-size: 22px; color: #0f2a5b;" onclick="dijit.byId('popupCalculator').show();" ></i></span>
				                <?php }?>
				                 <?php if($action=='index' AND $module!='report' AND $module!='home' AND $controller!='studentnearlyendservice' AND $controller!='studentpaymentlate' AND $controller!='studentpaymentlate' AND $module!='allreport'){?>
				                	 <a class='add-link' style="float:right;" href="<?php echo $this->url(array('module'=>$module,'controller'=>$controller,'action'=>'add'),null,true); ?>"><?php echo $tr->translate('ADD');?> <i class="fa fa-plus-circle" aria-hidden="true"></i></a>
								<?php }elseif($action=='add' OR $action=='edit' OR $action=='copy' OR $action=='view' OR $module=='report'){?>
								 	<span style="padding-left: 3px;padding-right: 3px; float: right; font-weight:600;"><a class='add-link' style="float:right;" href="<?php echo $this->url(array('module'=>$module,'controller'=>$controller,'action'=>'index'),null,true); ?>"><i class="fa fa-arrow-circle-o-left" aria-hidden="true"></i> <?php echo $tr->translate('GO_BACK');?></a></span>
								<?php }?>
						</p>
						
            	</td>
            </tr>
             <tr>
                	<td colspan="2" height="60px;"></td>
                </tr>
            <tr>
            		<td colspan="2" valign="top" width="99%" >
            			<div class="col-sm-12" style=" padding: 0;">
            				<?php if($module!='home') {?>
	           			<div class="left-blog col-sm-2" style=" padding: 0;">
	           				<div class="left-blog-menu" >
            					<?php 
				            		if(!empty($arr_module)){
				            			echo $this->render('menuleft.phtml');
				            		}
				            		if(!empty($teacher_id)){
				            	?>
				            		<div id="header-left">
										<ul><li><a href="<?php echo $this->url(array("module"=>'foundation','controller'=>'teacherscore','action'=>'index'));?>">Teacher Score</a></li>
										</ul>
									</div>
									<?php }?>
            				</div>
	           			</div>
	           			<?php }?>
	           			<div class="<?php if($module!='home') { echo 'col-sm-10'; }else{?><?php echo 'col-sm-12'; }?>">
	           				<?php if($module=='allreport' AND $action!='index' AND $action!='rpt-certificate' ){?>
								<div class="ptss-frame  js-ptss-frame "><!-- is-opened -->
									<div class="ptss__toggle-btn  js-ptss-toggle-btn ">
										<i class="fa fa-print"></i>
									</div>
									<div class="ptss__header"><?php echo $tr->translate("PRINT");?></div>
									<div class="ptss__settings">
										<div class="ptss__single-setting" id="ptss__layout">
											<div class="ptss__setting-control">
												<div class="ptss__layout-wrapper">
													<a class="qButton" title="<?php echo $tr->translate("Preview");?>" href="#" onclick="preview();"><i class="fa fa-search" aria-hidden="true"></i></a>
													<a class="qButton print" href="#" title="<?php echo $tr->translate("PRINT");?>" onclick="doPrint();" ><i class="fa fa-print" aria-hidden="true"></i></a>
													<a class="qButton excel" href="#"  title="<?php echo $tr->translate("Export");?>"  onclick="exportExcel();"><i class="fa fa-file-excel-o" aria-hidden="true"></i></a>
												</div>
												
											</div>
										</div>
									</div>
								</div>
								<div style="clear:both;"></div>
								<?php }?>
								<?php if($module!='home' AND ($module=="library" AND $controller !="index" ) OR ( $module=="home" AND $controller!=="index") ) {?>
								<section class="inputmask">
									<div class="row">
								    	<div class="col-sm-12">
								    	<?php }?>
								    	<?php 
											$db = new Application_Model_DbTable_DbUsers();
					            			$rs = $db->getAccessUrl($module,$controller,$action);
				
					            			
					            			echo $this->layout()->content;
					            			
											/*
					            			if(!empty($rs) OR $action=='changepassword'){
				
					            				echo $this->layout()->content;
					            			}else{
					            				echo $this->render('pagenotfund.phtml');
					            			}
					            			*/
				            			 ?>
								    	<?php if($module!='home' AND ($module=="library" AND $controller !="index" ) OR ( $module=="home" AND $controller!=="index") ) {?>
			            			 </div>
			            		</div>
			            	</section>
            			 <?php }?>
	           			</div>
	           			<div style="clear:both;"></div>
	           			</div>
	           			<?php  if( $module!='home') { echo $this->render('calculator.phtml'); }?>
            		</td>
           	</tr>
        </table>
        <div class="marqee-block" style=" position: fixed; bottom: 0; z-index: 1; width: 100%; background: #0f2a5b; color: #fff;">
    		<marquee style=" margin-bottom: 0; padding: 5px 0; padding-bottom: 0;" behavior="scroll" direction="left" onmouseout="this.start()" onmouseover="this.stop()" scrollamount="5" style="">Copyright © Cam App Technology,All Rights Reserved.
             		Developed by Cam App Technology | <?php echo $tr->translate("អភិវឌ្ឍន៍ដោយ ខេម អ៊ែប តិចណូឡូជី");?>
					Tel : 085 911 912 | 070 75 64 57</marquee>
   		 </div>
    </body>
    <iframe name=print_frame width=0 height=0 frameborder=0 src=about:blank></iframe>
    <script src="<?php echo $this->baseUrl()."/datatable/";?>bootstrap.min.js"></script>
<?php if($module=='allreport' AND $action!='index' OR $action='allreports' OR $action='studentnearlyendservice' OR $action='studentpaymentlate'){?>
<script type="text/javascript">
function doPrint() {
	window.frames["print_frame"].document.body.innerHTML=dojo.byId('divPrint').innerHTML;
    window.frames["print_frame"].window.focus();
    window.frames["print_frame"].window.print();
    hideDialog();
}
function hideleft(){
	(dojo.style("leftmenu","display") == "none") ? 'show':'hide'();
}
function preview()
{ 
  var disp_setting="toolbar=no,status=no,resizable=no,location=no,directories=yes,menubar=no,"; 
      disp_setting+="scrollbars=no,width=1100, height=700, left=100, top=25"; 
  var content_vlue = document.getElementById("divPrint").innerHTML; 
  
  var docprint=window.open("","",disp_setting); 
   docprint.document.open(); 
   docprint.document.write('<html><head>'); 
   docprint.document.write('</head><div style=" font-size:16px !important; margin:0px; font-family:Verdana;"><style>table th {font-size:14px !important;} table td{font-size:12px !important;}</style><center>');          
   docprint.document.write(content_vlue);          
   docprint.document.write('</center></div></html>'); 
   docprint.document.close(); 
   docprint.focus(); 
}
function exportExcel(){
	$('#exportExcel').tableExport({type:'excel',escape:'false'});
}
jQuery(function () {
	'use strict';
	
	jQuery(".ptss__toggle-btn").click(function () {	
		jQuery('.js-ptss-frame').toggleClass('is-opened');
	});
	
	jQuery('.ptss__layout-wrapper > div').click(function(){
		
		jQuery(this).closest('.ptss__setting-control').find('.ptss__layout-wrapper').removeClass('is-selected');
		
		jQuery(this).parent().addClass('is-selected');
		
		if( jQuery(this).hasClass('ptss__layout-box--wide') ) {
			
			jQuery('body').removeClass('boxed');
			jQuery('#ptss__boxed-bg').hide();
			
			jQuery('body').removeClass('bg1').removeClass('bg2').removeClass('bg3').removeClass('bg4');
			
			jQuery('#ptss__boxed-backgrounds span').removeClass('is-selected');
			
		} else {
			
			jQuery('body').addClass('boxed');
			jQuery('#ptss__boxed-bg').show();
			
		}
		
	});
})
</script>
<?php  }?>
</html>

