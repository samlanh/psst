<?php
	$tr = Application_Form_FrmLanguages::getCurrentlanguage();
	$this->headTitle('បង្កាន់ដៃបង់ប្រាក់'); 
	echo $this->headTitle();
	$base_url = Application_Form_FrmMessage::getUrl("/");
?>
<style>
#footer{display: none;}
table tr td strong{
	padding-left: 0px;
}
.defaulheight{line-height: 22px !important;}
</style>
<div class="ptss-frame  js-ptss-frame "><!-- is-opened -->
	<div class="ptss__toggle-btn  js-ptss-toggle-btn ">
		<i class="fa fa-print"></i>
	</div>
	<div class="ptss__header"><?php echo $tr->translate("PRINT");?></div>
	<div class="ptss__settings">
		<div class="ptss__single-setting" id="ptss__layout">
			<div class="ptss__setting-control">
				<div class="ptss__layout-wrapper">
					<a class="qButton" title="<?php echo $tr->translate("Preview");?>" href="#" onclick="preview();"><i class="fa fa-search" aria-hidden="true"></i></a>
					<a class="qButton print" href="#" title="<?php echo $tr->translate("PRINT");?>" onclick="doPrint();" ><i class="fa fa-print" aria-hidden="true"></i></a>
					<a class="qButton excel" href="#"  title="<?php echo $tr->translate("Export");?>"  onclick="exportExcel();"><i class="fa fa-file-excel-o" aria-hidden="true"></i></a>
				</div>
			</div>
		</div>
	</div>
</div>
<div style="min-height:10cm; margin:0 auto; padding:0.5cm 0.5cm 0cm 0.5cm">	
	<div class="card-box">
   		<div class="col-sm-12 border-botom">
	    	<div class="col-sm-8 pd-0">
    			<h4 class="m-b-0"><i class="fa fa-file " aria-hidden="true"></i>&nbsp;&nbsp;&nbsp;<?php echo $tr->translate('បង្កាន់ដៃបង់ប្រាក់');?></h4>
   			</div>
   			<div class="col-sm-4 text-right">
   			</div>
   		</div>
   	</div>
   	<div style="min-height:26cm; margin:0 auto; padding:0.5cm 0.5cm 0cm 0.5cm">
   		<div id="divPrint">
			<?php 
			$amount_print = $this->data['receipt_print'];
			for($prin=0;$prin<$amount_print;$prin++){?>
			<table width="100%"  class="print" cellspacing="0"  cellpadding="0" style="height:10.97cm; font-family: 'Khmer OS Battambang' !important; font-size:11px !important; margin-top: -14px;white-space:nowrap;">
				<tr height="90px;">
					<td colspan="10"  style="" align="center" valign="top">
						<?php echo $this->header?>
					</td>
				</tr>
				
				<style>
					.bold{
						font-weight:bold;
						}
				</style>
				<tr height="40px;">
					<td colspan="10"  style="" align="center" valign="top">
						<table width="100%" style="font-size: 10px;margin-top: -15px;">
							<tr>
								<td width="30%"></td>
								<td align="center" width="40%" style="font-size: 16px;font-weight: bold;line-height: 20px;">
									<div style="font-family:Khmer OS Muol, Times New Roman;font-size: 16px;">បង្កាន់ដៃបង់ប្រាក់</div>
									OFFICIAL RECEIPT
								</td>
								<td width="30%" valign="center" align="center">
								</td>
							</tr>
						</table>
					</td>
				</tr>
				<style>
					.h{ margin-top: -3px;margin-bottom: 3px;}
					.tab_row{ margin-top: -8px;}
					
					.h1{ margin-top: -6px;}
					.values{ min-height: 25px; padding: 2px 5px;display: block; font-family: Khmer OS battambang ,Times New Roman;}
							
					.fonteng{font-size:16px;}
					.one{white-space:nowrap;font-size:16px;}
					.border{border:1px solid #000; min-width:220px}
				</style>
				<tr>
					<td colspan="10" valign="top">
						<table class='defaulheight' width="100%" border="0" style="font-family: Khmer OS Battambang , Times New Roman;font-size:12px; white-space:nowrap;margin-top:-5px;line-height: 20px;">
							<tr style="height: 30px;">
								<td class="one ">&nbsp;<?php echo $tr->translate("RECEIPT_NO");?>&nbsp;</td>
								<td class="border values one"><?php echo $this->row['invoice']?> </td>
								<td class="one " align="left">&nbsp;<?php echo $tr->translate("FOR_DATE");?>&nbsp;</td>
								<td class="border values one"><?php echo date("d/M/Y",strtotime($this->row['date']));?></td>
							</tr>
							
							<tr style="height: 30px;">
								<td class="one ">&nbsp;<?php echo $tr->translate("INCOME_TITLE");?>&nbsp;</td>
								<td class="border values one"><?php echo $this->row['title']?> </td>
								<td class="one " align="left">&nbsp;<?php echo $tr->translate("INCOME_CATEGORY");?>&nbsp;</td>
								<td class="border values one"><?php echo $this->row['cate_income']?></td>
							</tr>
							
							<tr style="height: 30px;">
								<td class="one ">&nbsp;<?php echo $tr->translate("PAYMENT_METHOD");?>&nbsp;</td>
								<td class="border values one"><?php echo $this->row['payment_method']?> </td>
								<td class="one " align="left">&nbsp;<?php echo $tr->translate("TOTAL_INCOME");?>&nbsp;</td>
								<td class="border values one"><?php echo $this->row['total_amount']?></td>
							</tr>
							
							<tr style="height: 30px;">
								<td class="one ">&nbsp;<?php echo $tr->translate("CHEQE_NO");?>&nbsp;</td>
								<td class="border values one"><?php echo $this->row['cheqe_no']?> </td>
								<td class="one " align="left">&nbsp;<?php echo $tr->translate("NOTE");?>&nbsp;</td>
								<td class="border values one">&nbsp;<?php echo $this->row['description']?></td>
							</tr>
							
							<tr style="font-size: 15px; font-weight:bold;font-family:'Khmer MEF2'">
								<td colspan="2" align="center" >អ្នកប្រគល់</td>
								<td colspan="2" align="center">អ្នកទទួល</td>
							</tr>
							<tr style="font-size: 15px;">
								<td colspan="4" align="center">&nbsp;</td>
							</tr>
							<tr style="font-size: 15px;">
								<td colspan="2" align="center"></td>
								<td colspan="2" align="center" style="line-height: 13px;">
									<h4 style="font-weight:bold;font-family: Arial Black;color:#000; font-size: 13px;font-family:'Khmer OS Battambang';"> 
								        <?php 
										   echo $this->row['last_name']." ".$this->row['first_name'];
										?>
					        		</h4>
					        		<div style="font-size: 12px;margin-top:-10px;">
					        			<?php  echo date("F j, Y, g:i a",strtotime($this->row['create_date']));?>
					        		</div>
					        	</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
			<?php //if($print==0){?>
				<!-- <hr style="border:1px dotted #000;" /> -->
			<?php }//}?>
			
	</div>	
   	</div>
</div>
    	
<script type="text/javascript">
dojo.ready(function(){
});	
function readMoneyInKhmer(netTotal){
	var str = netTotal.toString();
    str_cent = 'សេន';
	first_decimal = str.substr(-2);
	last_decimal = str.substr(-1);
    if(first_decimal>0){string='និង';}else{string="";str_cent=""}
	if(first_decimal!='00' && first_decimal<10 ){str_zero = "សូន្យ";}else{str_zero='';}
    first_money_decimal = read_in_khmer_from_10_to_99(first_decimal);
    last_money_decimal = read_in_khmer_from_0_to_9(last_decimal)
    money_khmer=read_money_in_khmer(netTotal);

    if(first_decimal>0){string_en='និង';}else{string_en="";str_cent_en=""}
	if(first_decimal!='00' && first_decimal<10 ){str_zero_en = "Zero";}else{str_zero_en='';}
    first_money_decimal_en = read_in_english_from_10_to_99(first_decimal);
    last_money_decimal_en = read_in_english_from_0_to_9(last_decimal)
    money_english=read_money_in_english(netTotal);
    read_eng = money_english.trim()+string+ first_money_decimal+str_zero+last_money_decimal+'ដុល្លារគត់'

    read_eng = '( '+money_english.trim()+string_en+ first_money_decimal_en+str_zero_en+last_money_decimal_en+' Dollar Only )'
    dojo.byId("lbl_moneykhmer").innerHTML = money_khmer.trim()+string+ first_money_decimal+str_zero+last_money_decimal+'ដុល្លារគត់'+read_eng
}

function doPrint() {
	window.frames["print_frame"].document.body.innerHTML=dojo.byId('divPrint').innerHTML;
    window.frames["print_frame"].window.focus();
    window.frames["print_frame"].window.print();
    hideDialog();
}
function hideleft(){
	(dojo.style("leftmenu","display") == "none") ? 'show':'hide'();
}
function preview()
{ 
  var disp_setting="toolbar=no,status=no,resizable=no,location=no,directories=yes,menubar=no,"; 
      disp_setting+="scrollbars=no,fullscreen=yes, height=700, left=100, top=25"; 
  var content_vlue = document.getElementById("divPrint").innerHTML; 
  var docprint=window.open("","",disp_setting); 
   docprint.document.open(); 
   docprint.document.write('<html><head>'); 
   docprint.document.write('</head><div style=" font-size:16px !important; margin:0px; font-family:Verdana;"><style>table th {font-size:14px !important;} table td{font-size:12px !important;}</style><center>');          
   docprint.document.write(content_vlue);          
   docprint.document.write('</center></div></html>'); 
   docprint.document.close(); 
   docprint.focus(); 
}
function exportExcel(){
	$('#exportExcel').tableExport({type:'excel',escape:'false'});
}
</script>