<?php
$tr = Application_Form_FrmLanguages::getCurrentlanguage();
$frm = $this->frm_expense;
?>
<title>Add Other Expense</title>
<style>	
.fullside {
	width: 100%;
	height: 30px;
}
</style>
 <script>
		require(["dijit/form/DateTextBox","dijit/form/NumberTextBox"]);
 </script>
<form id='office_receipt' action="<?php echo $this->url(array('module'=>'registrar','controller'=>'expense','action'=>'add')); ?>" 
		dojoType="dijit.form.Form" method="post" enctype="application/x-www-form-urlencoded">
<script type="dojo/method" event="onSubmit">			
	if(this.validate()) {
		return true;
	}else {
		return false;
	}
</script>
<table cellspacing="10" class='fullside' >
	<tr>
		<td>
			<fieldset>
				<legend><strong>ចំណាយ</strong></legend>
				<table cellspacing="10"  width="100%">
					<tr>
					    <td><?php echo $tr->translate("BRANCH_NAME")?></td>
						<td><?php echo $frm->getElement('branch_id');?></td>
						<td><?php echo $tr->translate("EXPENSE_TITLE")?></td>
						<td><?php echo $frm->getElement('title');?></td>
						<td><?php echo $tr->translate("Payment Method")?></td>
						<td><?php echo $frm->getElement('payment_method');?></td>
					</tr>
					<tr>
					    <td><?php echo $tr->translate("CHEQUE_NO")?></td>
						<td><?php echo $frm->getElement('cheque_num');?></td>
					    <td><?php echo $tr->translate("RECEIPT_NO")?></td>
						<td><?php echo $frm->getElement('invoice');?></td>
						<td><?php echo $tr->translate("TOTAL_EXPENSE")?></td>
						<td><?php echo $frm->getElement('total_amount');?></td>
					</tr>
					<tr>
						<td><?php echo $tr->translate("CREATED_DATE")?></td>
						<td><?php echo $frm->getElement('Date');?></td>
						<td valign="top"><?php echo $tr->translate("STATUS")?></td>
						<td valign="top"><?php echo $frm->getElement('Stutas');?></td>
						<td valign="top"><?php echo $tr->translate("NOTE")?><input type="hidden" id="identity" name="identity" /></td>
						<td><?php echo $frm->getElement('Description');?></td>
					</tr>
					<tr>
						<td colspan="6">
							<table id="table_row" style="border-collapse: collapse; border:1px solid #ccc;white-space: nowrap;width:100%;">
								<tr id="head-title" class="head-td" align="right"></tr>
							</table>
						</td>
					</tr>
					<tr>
						<td colspan="6" align="left">
							<input type="button" label="<?php echo $tr->translate('ADD_ROW');?>" dojoType="dijit.form.Button" 
						 	   iconClass="dijitIconEditProperty" onclick="addRow();" />
						</td>
					</tr>
				</table>
			</fieldset>
		</td>
	</tr>		
	<tr>
		<td align="center">
		<input type="reset" label="<?php echo $tr->translate("CLEAR")?>" dojoType="dijit.form.Button"
				 iconClass="dijitIconClear"/>
			<input type="button" onclick="submitData();" label="<?php echo $tr->translate("SAVECLOSE");?>" id='saveclose' name='saveclose' value='saveclose' dojoType="dijit.form.Button"
				 iconClass="dijitIconDelete"/>
			<input type="button" onclick='printSave("");' label="<?php echo $tr->translate("SAVEPRINT")?>" name='savenew' value='savenew' dojoType="dijit.form.Button"
				 iconClass="dijitIconNewTask"/>
		</td>
	</tr>	
</table>
</form>
<<<<<<< .mine
||||||| .r330
<div class="dijitHidden" style="padding: 0px; margin: 0px;">
	<div data-dojo-type="dijit.Dialog" style="width:21cm;height: 15cm ;" align="center" data-dojo-props="title:'<?php echo $tr->translate("ប័ណ្ណចំណាយ");?>'" id="terms" >
		<div id="printexpense" style="width: 19cm !important; height: 11cm ; padding: 0px; margin-bottom:30px; ">
			<table width="100%"  class="print" cellspacing="0"  cellpadding="0" style=" font-family: 'Khmer OS Battambang' !important; height:10cm; font-size:11px !important; margin-top: -10px;white-space:nowrap;">
				<tr>
				    <td colspan="10"  style="" align="center">
						<table width="100%" style="font-size: 10px;margin-bottom: 0px;">
							<tr>
								<td width="30%">
									<img style="width: 55%;" alt="<?php ?>" src="<?php echo $this->baseUrl().'/images/logo_print.png'?>"><br />
								</td>
								<td width="40%" align="center" valign="top" style="">
									<div style="font-size: 14px;text-align:center;font-family: Khmer OS Muol Light;">សាលាបញ្ញាសាស្រ្ត អន្តរជាតិ</div>
									<div style="font-size: 12px;font-family:Battambang,Arial,Helvetica,sans-serif">Paññāsāstra International School</div> 
									<div style="font-size: 13px;font-family: khmer OS Muol Light;">ប័ណ្ណចំណាយ</div> 
									<div style="font-size: 13px;font-family:Battambang,Arial,Helvetica,sans-serif;margin-top:2px;">PAYMENT VOUCHER</div> 
								</td>
								<td width="30%">
									<div style="font-size: 16px;font-weight:bold;text-align:center;">
										N<sup>o</sup> : <label id="lb_receipt_no"></label>
									</div>
								</td>
							</tr>
						</table>
				    </td>
				</tr>
				<tr>
					<td colspan="10">
						<table width="100%" style="font-family: Khmer OS Battambang;font-size:14px;white-space:nowrap;margin-top:-8px;line-height: 17px;">
							<tr >
								<td width="10%"></td>
								<td width="18%"></td>
								<td width="9%"></td>
								<td width="18%"></td>
								<td width="4%"></td>
								<td width="8%"></td>
								<td width="4%"></td>
								<td width="5%"></td>
								<td width="3%"></td>
								<td width="8%"></td>
							</tr>
							<tr >
								<td class="one ">ចំណាយឱ្យ​ <br />Pay To </td>
								<td valign="top"> :&nbsp; <label id="bl_payfor"></label> </td>
								<td  align="center">ថ្ងៃចំណាយ </br />Paid Date</td>
								<td valign="top"> :&nbsp; <label id="lb_paiddate"></label> </td>
								<td colspan="3"><label id="" >ចំណាយជា  </br />Payment Method</label></td>
								<td colspan="3" valign="top">:&nbsp;<label id="lb_paymentmehtod"></label></td>
							</tr>
							<tr>
								<td>សម្គាល់  </br /> Note </td>
								<td colspan="9" valign="top"> :&nbsp; <label id="lb_note"></label></td>
							</tr>
							<tr>
								<td colspan="10">
									<div id="t_amountmoneytype"></div>
								</td>
							</tr>
							<tr>
								<td colspan="10" valign="bottom">
									<table width="100%"   style="font-family:'Khmer OS Battambang';font-size:14px; line-height:18px;margin-top:-5px;margin-bottom:5px;">
										<tr>
											<td width="20%"></td>
											<td width="20%"></td>
											<td width="15%"></td>
											<td width="15%"></td>
											<td width="15%"></td>
											<td width="15%"></td>
										</tr>
										<tr>
											<td colspan="2"  align="center">
												<div style="margin-top:-5px;"></div>
											</td>
											<td colspan="2">
												&nbsp;
											</td>
											<td>
												<div style="margin-top:-15px;"></div>
											</td>
											<td>
											</td>
										</tr>
										<tr>
											<td colspan="4"></td>
											<td>
												<div style="margin-top:-20px;">ចំណាយសរុប <br />Paid Amount</div>
											</td>
											<td>
												<div style="width:100%;border-bottom:1px solid #000;margin-bottom:px;margin-top: -20px; font-weight: bold;font-size: 16px;">: &nbsp;<label id="lb_total_received"> </label></div>
											</td>
										</tr>
										<tr >
											<td colspan="2" align="center" valign="top">
												<div style="font-weight:bold;color:#000; font-size: 14px;margin-top:-10px;"> 
													<?php 
													   $session_user=new Zend_Session_Namespace('authstu');
													   $last_name=$session_user->last_name;
													   $username = $session_user->first_name;
													   echo"Paid By : ".$last_name." ".$username;
													?>
												</div>
											</td>
											<td colspan="2" valign="top">
												<div style="font-weight:bold;color:#000; font-size: 14px;margin-top:-10px;"> 
													<?php 
													   echo"Received By :........................ &nbsp;&nbsp;";
													?>
												</div>
											</td>
											<td></td>
											<td></td>
										</tr>
										<tr>
											<td colspan="2" align="center" >
												<div style="width:70%;border-bottom:1px solid #000;margin-bottom:10px;margin-top: 30px;"></div>
												<div style="margin-top:-11px;">Date : <?php echo date('d / m / Y , H:i:s ',strtotime(Zend_Date::now()));?></div>
											</td>
											<td colspan="2" align="center" width="30%">
												<div style="width:70%;border-bottom:1px solid #000;margin-bottom:10px;margin-top: 30px;"></div>
												<div style="margin-top:-11px;">Date : &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; / &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; / &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; / </div>
											</td>
											<td colspan="2" align="center"></td>
										</tr>
									</table>
								</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</div>
		<button dojoType="dijit.form.Button" iconClass="dijitEditorIcon dijitEditorIconCancel"
				type="button" onclick="hideDialog();">Cancel</button>
		<button dojoType="dijit.form.Button" iconClass="dijitEditorIcon dijitEditorIconPrint"
				 type="button" onclick="doPrintInvoice();"><?php echo $tr->translate("SAVE_PRINT");?></button>
	</div>
</div>
<iframe name=print_frame width=0 height=0 frameborder=0 src=about:blank></iframe>	
=======
<div class="dijitHidden" style="padding: 0px; margin: 0px;">
	<div data-dojo-type="dijit.Dialog" style="width:21cm;height: 15cm ;" align="center" data-dojo-props="title:'<?php echo $tr->translate("ប័ណ្ណចំណាយ");?>'" id="terms" >
		<div id="printexpense" style="width: 19cm !important; height: 11cm ; padding: 0px; margin-bottom:30px; ">
			<table width="100%"  class="print" cellspacing="0"  cellpadding="0" style=" font-family: 'Khmer OS Battambang' !important; height:10cm; font-size:11px !important; margin-top: -10px;white-space:nowrap;">
				<tr>
				    <td colspan="10"  style="" align="center">
						<table width="100%" style="font-size: 10px;margin-bottom: 0px;">
							<tr>
								<td width="30%">
									<img style="width: 55%;" alt="<?php ?>" src="<?php echo $this->baseUrl().'/images/logo_print.png'?>"><br />
								</td>
								<td width="40%" align="center" valign="top" style="">
									<div style="font-size: 14px;text-align:center;font-family: Khmer OS Muol Light;"><?php echo $tr->translate('CUSTOMER_BRANCH');?></div>
									<div style="font-size: 12px;font-family:Battambang,Arial,Helvetica,sans-serif"><?php echo $tr->translate('SCHOOL_NAME');?></div> 
									<div style="font-size: 13px;font-family: khmer OS Muol Light;">ប័ណ្ណចំណាយ</div> 
									<div style="font-size: 13px;font-family:Battambang,Arial,Helvetica,sans-serif;margin-top:2px;">PAYMENT VOUCHER</div> 
								</td>
								<td width="30%">
									<div style="font-size: 16px;font-weight:bold;text-align:center;">
										N<sup>o</sup> : <label id="lb_receipt_no"></label>
									</div>
								</td>
							</tr>
						</table>
				    </td>
				</tr>
				<tr>
					<td colspan="10">
						<table width="100%" style="font-family: Khmer OS Battambang;font-size:14px;white-space:nowrap;margin-top:-8px;line-height: 17px;">
							<tr >
								<td width="10%"></td>
								<td width="18%"></td>
								<td width="9%"></td>
								<td width="18%"></td>
								<td width="4%"></td>
								<td width="8%"></td>
								<td width="4%"></td>
								<td width="5%"></td>
								<td width="3%"></td>
								<td width="8%"></td>
							</tr>
							<tr >
								<td class="one ">ចំណាយឱ្យ​ <br />Pay To </td>
								<td valign="top"> :&nbsp; <label id="bl_payfor"></label> </td>
								<td  align="center">ថ្ងៃចំណាយ </br />Paid Date</td>
								<td valign="top"> :&nbsp; <label id="lb_paiddate"></label> </td>
								<td colspan="3"><label id="" >ចំណាយជា  </br />Payment Method</label></td>
								<td colspan="3" valign="top">:&nbsp;<label id="lb_paymentmehtod"></label></td>
							</tr>
							<tr>
								<td>សម្គាល់  </br /> Note </td>
								<td colspan="9" valign="top"> :&nbsp; <label id="lb_note"></label></td>
							</tr>
							<tr>
								<td colspan="10">
									<div id="t_amountmoneytype"></div>
								</td>
							</tr>
							<tr>
								<td colspan="10" valign="bottom">
									<table width="100%"   style="font-family:'Khmer OS Battambang';font-size:14px; line-height:18px;margin-top:-5px;margin-bottom:5px;">
										<tr>
											<td width="20%"></td>
											<td width="20%"></td>
											<td width="15%"></td>
											<td width="15%"></td>
											<td width="15%"></td>
											<td width="15%"></td>
										</tr>
										<tr>
											<td colspan="2"  align="center">
												<div style="margin-top:-5px;"></div>
											</td>
											<td colspan="2">
												&nbsp;
											</td>
											<td>
												<div style="margin-top:-15px;"></div>
											</td>
											<td>
											</td>
										</tr>
										<tr>
											<td colspan="4"></td>
											<td>
												<div style="margin-top:-20px;">ចំណាយសរុប <br />Paid Amount</div>
											</td>
											<td>
												<div style="width:100%;border-bottom:1px solid #000;margin-bottom:px;margin-top: -20px; font-weight: bold;font-size: 16px;">: &nbsp;<label id="lb_total_received"> </label></div>
											</td>
										</tr>
										<tr >
											<td colspan="2" align="center" valign="top">
												<div style="font-weight:bold;color:#000; font-size: 14px;margin-top:-10px;"> 
													<?php 
													   $session_user=new Zend_Session_Namespace('authstu');
													   $last_name=$session_user->last_name;
													   $username = $session_user->first_name;
													   echo"Paid By : ".$last_name." ".$username;
													?>
												</div>
											</td>
											<td colspan="2" valign="top">
												<div style="font-weight:bold;color:#000; font-size: 14px;margin-top:-10px;"> 
													<?php 
													   echo"Received By :........................ &nbsp;&nbsp;";
													?>
												</div>
											</td>
											<td></td>
											<td></td>
										</tr>
										<tr>
											<td colspan="2" align="center" >
												<div style="width:70%;border-bottom:1px solid #000;margin-bottom:10px;margin-top: 30px;"></div>
												<div style="margin-top:-11px;">Date : <?php echo date('d / m / Y , H:i:s ',strtotime(Zend_Date::now()));?></div>
											</td>
											<td colspan="2" align="center" width="30%">
												<div style="width:70%;border-bottom:1px solid #000;margin-bottom:10px;margin-top: 30px;"></div>
												<div style="margin-top:-11px;">Date : &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; / &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; / &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; / </div>
											</td>
											<td colspan="2" align="center"></td>
										</tr>
									</table>
								</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</div>
		<button dojoType="dijit.form.Button" iconClass="dijitEditorIcon dijitEditorIconCancel"
				type="button" onclick="hideDialog();">Cancel</button>
		<button dojoType="dijit.form.Button" iconClass="dijitEditorIcon dijitEditorIconPrint"
				 type="button" onclick="doPrintInvoice();"><?php echo $tr->translate("SAVE_PRINT");?></button>
	</div>
</div>
<iframe name=print_frame width=0 height=0 frameborder=0 src=about:blank></iframe>	
>>>>>>> .r333
<script type="text/javascript">
<<<<<<< .mine
	dojo.require("dijit.form.Textarea");
	dojo.require("dojo.data.ItemFileWriteStore");  
	dojo.require("dojo.NodeList-manipulate");
	dojo.require("dojo.data.ObjectStore");
	dojo.require("dojo.store.Memory");
	
	dojo.ready(function(){
		
	});

	function popupCateExpense(index){
		expense_id = dijit.byId("expense_id"+index).get('value');
		$("#tow_value").val(index);
		if(expense_id==-1){
			dijit.byId("popup_cate_expense").show();
||||||| .r330
dojo.require("dijit.form.Textarea");
dojo.require("dojo.data.ItemFileWriteStore");  
dojo.require("dojo.NodeList-manipulate");
dojo.require("dojo.data.ObjectStore");
dojo.require("dojo.store.Memory");
dojo.ready(function(){
	getReceiptNumber("");
	addRow();
});
function hideDialog(){
	dijit.byId('terms').hide();
}
var url_get_recceipt_number = "<?php echo $this->url(array('module'=>'registrar','controller'=>'expense','action'=>'get-receipt-number')); ?>";
function getReceiptNumber(receipt){
	dojo.xhrPost({
		url:url_get_recceipt_number,
		content:{
			'branch_id':dijit.byId('branch_id').get('value')
			},
		handleAs:"json",
		load: function(data) {
			 dijit.byId('invoice').attr('value',data);
			 if(receipt!=''){
				 printSave(data);
			}
		},
		error: function(err) {
			alert(err);
=======
dojo.require("dijit.form.Textarea");
dojo.require("dojo.data.ItemFileWriteStore");  
dojo.require("dojo.NodeList-manipulate");
dojo.require("dojo.data.ObjectStore");
dojo.require("dojo.store.Memory");
dojo.ready(function(){
	getReceiptNumber("");
	addRow();
	dijit.byId('payment_method').attr('value',1);
});
function hideDialog(){
	dijit.byId('terms').hide();
}
var url_get_recceipt_number = "<?php echo $this->url(array('module'=>'registrar','controller'=>'expense','action'=>'get-receipt-number')); ?>";
function getReceiptNumber(receipt){
	dojo.xhrPost({
		url:url_get_recceipt_number,
		content:{
			'branch_id':dijit.byId('branch_id').get('value')
			},
		handleAs:"json",
		load: function(data) {
			 dijit.byId('invoice').attr('value',data);
			 if(receipt!=''){
				 printSave(data);
			}
		},
		error: function(err) {
			alert(err);
>>>>>>> .r333
		}
	}
	
	function hideDialog(){
		dijit.byId('popup_cate_expense').hide();
	}
	
	var cate_expense_store  = getDataStorefromJSON('id','name',<?php print_r(Zend_Json::encode($this->cate_expense));?> );
	var url_add_cate_expense = '<?php echo $this->url(array("module"=>"registrar","controller"=>"expense","action"=>"add-cate-expense")); ?>';
	function addCateExpense(){
		if(dijit.byId('add_cate_expense').validate()) {
			dojo.xhrPost({
				url:url_add_cate_expense,
				form: dojo.byId("add_cate_expense"),
				handleAs:"json",
				load: function(data){
				  var Itemmake = { 
					        id: data.id,
					        name: dijit.byId('account_name').get('value')
					         };
						index=$("#tow_value").val();
					    addDataToSelectbox(dijit.byId('expense_id'+index), cate_expense_store, Itemmake, data.id);
	
				  optexpense = data.new_array;
						  
				  dijit.byId('add_cate_expense').reset();
				  dijit.byId("popup_cate_expense").hide();
				},
				error: function(err) {
					alert(err);
				}
			});
		}
	}
</script>
<div class="dijitHidden">
	<div data-dojo-type="dijit.Dialog" style="width:30%;" id="popup_cate_expense" >
		<form  name='add_subject_exam' id='add_cate_expense'  dojoType="dijit.form.Form" method="post" enctype="application/x-www-form-urlencoded">
			<table cellspacing="10" width="100%" style="margin: 0 auto;">
				<tr>
					<td>
						<fieldset style="background-color:menu;">
							<legend align="center" style="font-size: 18px;"><strong><?php echo $tr->translate("ADD_NEW_SUBJECT");?></strong></legend>
							<table style="margin: 0 auto; width: 95%;white-space: nowrap;" cellspacing="10">
								
								<tr>
									<td><?php echo $tr->translate("TITLE")?></td>
									<td>
										<input name="account_name" id="account_name" dojoType="dijit.form.ValidationTextBox" required="required" class="fullside" />
									</td>
								</tr>
								<tr>
									<td colspan="2" align="center">
										<input iconClass="dijitIconUndo" type="button" name="close" id="close" value="close" label="Close" dojoType="dijit.form.Button" onclick="hideDialog();" />
										<input type="button" onclick="addCateExpense();" value="save_new" name="save_new" label="<?php echo $tr->translate('SAVE_NEW');?>" dojoType="dijit.form.Button" 
											iconClass="dijitEditorIcon dijitEditorIconSave" />
									</td>
								</tr>
							</table>	
						</fieldset>		
					</td>
				</tr>
			</table>	
			<input type="hidden"  name="tow_value" id="tow_value" value="" />
 			</form>
	</div>
</div>