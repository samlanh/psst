<?php
	$tr = Application_Form_FrmLanguages::getCurrentlanguage();
	$this->headTitle('Student Test Report'); 
	echo $this->headTitle();
	$base_url = Application_Form_FrmMessage::getUrl("/");
	$session_user=new Zend_Session_Namespace('authstu');
	$user_id=$session_user->user_id;
	$frm =  $this->form_search;
?>
<form  id='foundation_class' action="<?php echo $this->url(array('module'=>'registrar','controller'=>'rptstudenttest','action'=>'index')); ?>" dojoType="dijit.form.Form" method="post" enctype="application/x-www-form-urlencoded">
<table width="90%" style="margin: 0px;">
   <tr>
       <td colspan="4">
			<div class="menureport">
				<ul>
					<li class="preview"><a title="Preview" href="#" onclick="preview();"></a></li>
					<li class="print"><a href="#" title="Print" onclick="doPrint();" ></a></li>
					<li class="excel"><a href="#"  title="Export"  onclick="exportExcel();"></a></li>
				</ul>
			</div>
      </td>
	</tr>
	<tr> 
		<td><input dojoType="dijit.form.TextBox" class="fullside" id="adv_search" name="adv_search" value="<?php echo $this->search['adv_search']?>" placeholder="Search" type="text" ></td>
		<td> <?php echo $frm->getElement("branch_id");?></td>
		<td> <input dojoType="dijit.form.DateTextBox" class="fullside" constraints="{datePattern:'dd/MM/yyyy'}" id="start_date" name="start_date" value="<?php  echo $this->search['start_date']; ?>"  type="text"></td>
	 	<td><input dojoType="dijit.form.DateTextBox" constraints="{datePattern:'dd/MM/yyyy'}" class="fullside" id="end_date" name="end_date" value="<?php echo $this->search['end_date'];?>" type="text"></td>
		<td> <?php echo $frm->getElement("user");?></td>
		<td> <button iconclass="dijitIconSearch" dojoType="dijit.form.Button" showLabel="true" type="submit"><?php echo $tr->translate("SEARCH");?></button></td>
	</tr>
</table>
</form>
<style>
.hover:hover{ background: #ddd;}
</style>
<div style="border: 1px dotted #000;background: #fff;width:100%;margin: 0 auto;">
		<div id="divPrint"  >
			<table style="background:#fff; margin: 0 auto; width: 100%; padding: 1cm;" >
				<tr style="font-size: 13px;">
					<td width="15%" align="center">
						<img style="width:62%;" alt="<?php ?>" src="<?php echo $this->baseUrl().'/images/logo.png'?>"><br />
					</td>
					<td align="center"  width="70%">
						<strong style="font-weight:bold;font-family: Arial Black;color:#000; font-size: 16px;font-family:'Khmer MEF2';"><?php echo $tr->translate("CUSTOMER_BRANCH"); ?></strong><br />
						<strong style="font-weight:bold;font-family: Arial Black;color:#000; font-size: 16px;font-family:'Khmer MEF2';"><?php echo $tr->translate("STUDENT_PAYMENT_RECEIPT"); ?></strong><br />
						<strong style="font-weight:bold;font-family: Arial Black;color:#000; font-size: 14px;font-family:'Khmer MEF2';">For Date <?php echo date("d-M-Y",strtotime($this->search["start_date"]))?> to <?php echo date("d-M-Y",strtotime($this->search["end_date"]));?></strong><br /><br />
					</td>
					<td width="15%">&nbsp;</td>
				</tr>
				<tr>
					<td colspan="3" id="exportExcel">
							<style> th,td{ padding:0 1px;}</style>
							<style type="text/css">
								body{font-family: "Times New Roman",Arial; }
								table{ border-collapse:collapse; margin:0 auto;
								border-color:#000; }
								.padd tr td{  text-align:center}
								.padd tr th{  background-color: #e4e4e4; }
							</style>

						<table class="padd" width="100%" border="1" align="center" style="font-family: Khmer OS Battambang,Times New Roman ;">
							 
							 <?php 
							 	$i=0; $total=0;$total_paid=0;$total_balance=0;
							 	$comple_b=0; $isset =0; $total_other_income=0;
							 	$total_other_expense=0;
							 	$total_income_dollar=0;
							 	$total_income_kh = 0;
							 	$total_expense_dollar = 0;
							 	$total_expense_kh =0;
							 	if (!empty($this->row)){  
							 ?>
							 
							  <tr style="font-size:12px; height: 20px; white-space:nowrap;background: #ccc !important; line-height: 25px; font-weight: bold;" align="center">
							    <td rowspan="2">&nbsp;<?php echo $tr->translate("N_O"); ?>&nbsp;</td>
							    <td rowspan="2">&nbsp;<?php echo $tr->translate("SERIAL"); ?>&nbsp;</td>
								<td rowspan="2">&nbsp;<?php echo $tr->translate("NAME_KH"); ?>&nbsp;</td>
								<td rowspan="2">&nbsp;<?php echo $tr->translate("NAME_EN"); ?>&nbsp;</td>
								<td rowspan="2">&nbsp;<?php echo $tr->translate("SEX"); ?>&nbsp;</td>
								<td rowspan="2">&nbsp;<?php echo $tr->translate("PHONE"); ?>&nbsp;</td>
								
								<td colspan="3">&nbsp;<?php echo $tr->translate("RESULT"); ?>&nbsp;</td>
								
								
								<td rowspan="2">&nbsp;<?php echo $tr->translate("NOTE"); ?>&nbsp;</td>
								<td rowspan="2">&nbsp;<?php echo $tr->translate("CREATE_DATE"); ?>&nbsp;</td>
								<td rowspan="2">&nbsp;<?php echo $tr->translate("USER"); ?>&nbsp;</td>
								<td rowspan="2">&nbsp;<?php echo $tr->translate("STATUS"); ?>&nbsp;</td>
							  </tr>
							 <tr style="font-size:12px; height: 20px; white-space:nowrap;background: #ccc !important; line-height: 20px; font-weight: bold;" align="center">
							 	<td>&nbsp;<?php echo $tr->translate("DEGREE"); ?>&nbsp;</td>
								<td>&nbsp;<?php echo $tr->translate("GRADE"); ?>&nbsp;</td>
								<td>&nbsp;<?php echo $tr->translate("SESSION"); ?>&nbsp;</td>
							 </tr>
							 <style> 
								td{padding:0 3px; }
								table { page-break-inside:auto }
								tr{ page-break-inside:avoid; page-break-after:auto }
							 </style>
							 
							 <?php foreach($this->row as $rs){ $i++;?>
							 
								  <tr style="font-size:12px; height: 20px;white-space:nowrap;"â€‹ class="hover">
								    <td><?php echo $i;?></td>
								    <td><?php echo $rs['serial']; ?></td>
								    <td><?php echo $rs['kh_name']; ?></td>
								    <td><?php echo $rs['en_name']; ?></td>
								    <td><?php echo $rs['sex']; ?></td>
								    <td><?php echo $rs['phone']; ?></td>
								    
								    <td><?php echo $rs['degree_result']; ?></td>
								    <td><?php echo $rs['grade_result']; ?></td>
								    <td><?php echo $rs['session_result']; ?></td>
								    
								   	<td><?php echo $rs['note']; ?></td>
								    <td><?php echo $rs['user_id'];?></td>
								    <td><?php echo date('d-M-Y', strtotime($rs['create_date'])); ?></td>
								    
								    <td><?php echo $rs['updated_result']; ?></td>
								          
								    
								    
								  </tr>
							  <?php } }?>
						</table>
					</td>
				</tr>
			</table>
	</div>	
</div>
<script type="text/javascript">
function doPrint() {
	window.frames["print_frame"].document.body.innerHTML=dojo.byId('divPrint').innerHTML;
    window.frames["print_frame"].window.focus();
    window.frames["print_frame"].window.print();
    hideDialog();
}
function preview()
{ 
  var disp_setting="toolbar=no,status=no,resizable=no,location=no,directories=yes,menubar=no,"; 
      disp_setting+="scrollbars=no,width=1200, height=700, left=100, top=25"; 
  var content_vlue = document.getElementById("divPrint").innerHTML; 
  
  var docprint=window.open("","",disp_setting); 
   docprint.document.open(); 
   docprint.document.write('<html><head>'); 
   docprint.document.write('</head><div style=" font-size:16px !important; margin:0px; font-family:Verdana;"><style>table th {font-size:14px !important;} table td{font-size:12px !important;}</style><center>');          
   docprint.document.write(content_vlue);          
   docprint.document.write('</center></div></html>'); 
   docprint.document.close(); 
   docprint.focus(); 
}
function exportExcel(){
	$('#exportExcel').tableExport({type:'excel',escape:'false'});
}
</script>
