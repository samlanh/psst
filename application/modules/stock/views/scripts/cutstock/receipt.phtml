<meta charset="utf-8">
<script>
dojo.require("dijit.form.DateTextBox");
</script>
<style>
.hover:hover{background: #ccc;}
img.view{height: 70px !important;}
</style>
<?php $tr = Application_Form_FrmLanguages::getCurrentlanguage();?>
<title><?php echo $tr->translate("បង្កាន់ទទួលទំនិញ");?></title>
 <div style="min-height:26cm; margin:0 auto; padding:0.5cm 0.5cm 0cm 0.5cm">
	<div id="divPrint" style="width: 100%;">
			<style>
				.print tr td{
					padding:0px 2px 0px 2px; 
				}
				tr.hearder_table td {
				    padding: 5px;
				}
			</style>
			
			<?php for($i=0; $i<2; $i++){ ?>		
			<table width="100%"  class="print" cellspacing="0"  cellpadding="0" style="height:4cm;font-family: 'Times New Roman','Khmer OS Battambang' !important;font-size:15px !important;white-space:nowrap;">
					<tr>
						<td colspan="4">
							<div class="lbl_header">
							
							</div>
						</td>
					</tr>
					<tr>
						<td colspan="4" align="center">
							<strong style="font-family:'Khmer OS Muol';">បង្កាន់ទទួលទំនិញ</strong>
						</td>
					</tr>
					<tr>
						<td>Student's ID : <?php echo $this->row['stu_code'];?></td>
						<td></td>
						<td colspan="2" align="right"><span style="text-align:left; min-width: 100px; display: inline-block;">Ref Receipt No.</span> : <span style="text-align:left; color:red; min-width: 100px; display: inline-block;"><?php echo $this->row['serailno'];?><?php if($this->row['status']==0){echo "<span style='color:red;'>&nbsp;&nbsp;(Void)</span>";};?></span></td>
					</tr>
					<tr>
						<td>Student's Name : <?php echo $this->row['stu_enname']." ".$this->row['last_name'];?></td>
						<td></td>
						<td colspan="2" align="right"><span style="text-align:left; min-width: 100px; display: inline-block;">Received Date</span> : <span style="text-align:left; min-width: 100px; display: inline-block;"><?php echo date("d/M/Y",strtotime($this->row['received_date']));?></span></td>
						
					</tr>
					<tr>
						<td  colspan="4">
							<table border="1" align="center" style=" width: 100%; padding: 0px; margin-top: 3px !important; border-collapse: collapse; border: 1px solid #000; font-size:11px;font-family:Khmer OS Battambang !important; white-space:nowrap; ">
							  	<tr class="hearder_table" style=" font-size:12px; text-align:center;background:#f2f2f2;font-weight:bold;">
								  	<td>No</td>
								  	<td >Receipt</td>
								  	<td >Item Name</td>
								  	<td >Qty</td>
								  	<td >Qty Received</td>
								  	<td >Qty Balance</td>
								  	<td >Remain Date</td>
							  	</tr>
							  	<?php if (!empty($this->rowdetail)) foreach ($this->rowdetail as $key=> $row){?>
							  	<tr class="rowlist">
							  		<td align="center">&nbsp;<?php echo $key+1?>&nbsp;</td>
							  		<td align="center">&nbsp;<?php echo $row['receipt_number']?>&nbsp;</td>
							  		<td>&nbsp;<?php echo $row['items_name']?>&nbsp;</td>
							  		<td align="center">&nbsp;<?php echo $row['due_amount']?>&nbsp;</td>
							  		<td align="center">&nbsp;<?php echo $row['qty_receive']?>&nbsp;</td>
							  		<td align="center"> &nbsp;<?php echo $row['remain']?>&nbsp;</td>
							  		<td align="center">&nbsp;<?php if (!empty($row['remain']) OR $row['remain']>0){ echo date("d/M/Y",strtotime($row['remide_date']));}else{ echo '-';}?>&nbsp;</td>
							  	</tr>
							  	<?php }?>
							  	<tr class="rowlist">
									<td colspan="6" align="right" style=" border-bottom: #fff 1px solid; border-left: 1px solid #fff;">Total Received :</td>
									<td align="center">&nbsp;&nbsp;<?php echo $this->row['total_received'];?>&nbsp;</td>
								</tr>
								<tr class="rowlist">
									<td colspan="6" align="right" style=" border-bottom: #fff 1px solid; border-left: 1px solid #fff;">Total Remain :</td>
									<td align="center">&nbsp;&nbsp;<?php echo $this->row['total_qty_due'];?>&nbsp;</td>
								</tr>
							 </table>
						</td>
					</tr>
					<tr>
						<td colspan="2" width="50%" align="center">
							<div style="margin-top:40px;font-size:10px;"></div>
							<?php echo $tr->translate("INFORS_TO");?>
						</td>
						<td colspan="2" width="50%" align="center">
							<div style="margin-top:40px;font-size:10px;"></div>
							<?php echo $tr->translate("INFORS_RECEIVE");?>
						</td>
					</tr>
					<tr>
						<td colspan="2" width="50%" align="center">
							<div style="margin-top:30px;font-size:10px;"></div>
							
							<?php echo $this->row['user_name'];?>
						</td>
						<td colspan="2" width="50%" align="center">
							<div style="margin-top:30px;font-size:10px;"></div>
							<?php echo $this->row['stu_enname']." ".$this->row['last_name'];?>
						</td>
					</tr>
					<tr>
						<td colspan="4" align="right">
							<div style="font-size:10px;"><?php echo date('l , jS / m / Y , H:i:s ',strtotime(Zend_Date::now()));?></div>
						</td>
					</tr>
				</table>	
			<?php if($i==0){?>
					<div style="height: 30px; margin-top: 40px;">
						<div style="width: 100%;border-bottom:2px dashed #000; "></div>
					</div>
				<?php }?>
			<?php } ?>
	</div>
</div>
<div class="ptss-frame  js-ptss-frame "><!-- is-opened -->
	<div class="ptss__toggle-btn  js-ptss-toggle-btn ">
		<i class="fa fa-print"></i>
	</div>
	<div class="ptss__header"><?php echo $tr->translate("PRINT");?></div>
	<div class="ptss__settings">
		<div class="ptss__single-setting" id="ptss__layout">
			<div class="ptss__setting-control">
				<div class="ptss__layout-wrapper">
					<a class="qButton" title="<?php echo $tr->translate("Preview");?>" href="#" onclick="preview();"><i class="fa fa-search" aria-hidden="true"></i></a>
					<a class="qButton print" href="#" title="<?php echo $tr->translate("PRINT");?>" onclick="doPrint();" ><i class="fa fa-print" aria-hidden="true"></i></a>
					<a class="qButton excel" href="#"  title="<?php echo $tr->translate("Export");?>"  onclick="exportExcel();"><i class="fa fa-file-excel-o" aria-hidden="true"></i></a>
				</div>
			</div>
		</div>
	</div>
</div>
<script type="text/javascript">
dojo.ready(function(){
	getbranchinfo();
});
var url_getbranch = "<?php echo $this->url(array('module'=>'registrar','controller'=>'register','action'=>'getbranchinfo')); ?>";
function getbranchinfo(){
		branch_id = '<?php echo $this->row['branch_id'];?>';
		
		if(branch_id != ""){
			loadingBlock();
			dojo.xhrPost({
				url:url_getbranch,
				content:{
					'branch_id':branch_id,
					},
				handleAs:"json",
				load: function(data){
					$(".lbl_header").html(data);
					HideloadingBlock();
				},
				error: function(err) {
					alert(err);
				}
			});	
		} 
	}

function doPrint() {
	window.frames["print_frame"].document.body.innerHTML=dojo.byId('divPrint').innerHTML;
    window.frames["print_frame"].window.focus();
    window.frames["print_frame"].window.print();
    hideDialog();
}
function hideleft(){
	(dojo.style("leftmenu","display") == "none") ? 'show':'hide'();
}
function preview()
{ 
  var disp_setting="toolbar=no,status=no,resizable=no,location=no,directories=yes,menubar=no,"; 
      disp_setting+="scrollbars=no,fullscreen=yes, height=700, left=100, top=25"; 
  var content_vlue = document.getElementById("divPrint").innerHTML; 
  var docprint=window.open("","",disp_setting); 
   docprint.document.open(); 
   docprint.document.write('<html><head>'); 
   docprint.document.write('</head><div style=" font-size:16px !important; margin:0px; font-family:Verdana;"><style>table th {font-size:14px !important;} table td{font-size:12px !important;}</style><center>');          
   docprint.document.write(content_vlue);          
   docprint.document.write('</center></div></html>'); 
   docprint.document.close(); 
   docprint.focus(); 
}
function exportExcel(){
	$('#exportExcel').tableExport({type:'excel',escape:'false'});
}
</script>