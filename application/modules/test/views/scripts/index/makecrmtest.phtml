<?php
	$tr = Application_Form_FrmLanguages::getCurrentlanguage();
	echo $this->headTitle($tr->translate('CREATE_TO_STUDENT_TEST'));
	$frm = $this->frm_crm;
?>
<script src="<?php echo $this->baseUrl();?>/js/help.js"  type="text/javascript"></script>
<script src="<?php echo $this->baseUrl();?>/ckeditor/ckeditor.js"></script>
<style>
.image-box {
    text-align: center;
}
.image-box img {
    width: 120px;
    height: 130px;
}
.button_browse {
    position: relative;
    overflow: hidden;
    text-align: center;
    width: 100%;
    height: 38px;
    background: #fbf9f9;
    border: 1px solid #e8e8e8;
}
.button_browse span {
    line-height: 33px;
    font-weight: 600;
    cursor: pointer;
}
input.btn_borwse_image {
    position: absolute;
    width: 100%;
    height: 38px;
    top: 0;
    left: 0;
    z-index: 2;
    opacity: 0;
    cursor: pointer;
}
.account-image {
    border: solid 1px #eee;
    width: 120px;
    margin: 0 auto;
}
</style>
<script type="text/javascript">
    dojo.require("dojo.NodeList-manipulate");
    dojo.require("dojo.parser");
    dojo.require("dojo.data.ItemFileWriteStore");  
    dojo.require("dijit.form.Textarea");
</script>
<div class="card">
	<div class="card-content collapse show">
		<form id='frm_teststudent' action="" dojoType="dijit.form.Form" method="post" enctype="multipart/form-data">
			<script type="dojo/method" event="onSubmit" enctype="multipart/form-data">			
			if(this.validate()) {
				if(dijit.byId("branch_id").get("value")==''){
                    alert("<?php echo $tr->translate("PLEASE_SELECT_BRANCH");?>");
					dijit.byId("branch_id").focus();
					return false;
				}
				if(dijit.byId("degree").get("value")==''){
                    alert("<?php echo $tr->translate("PLEASE_SELECT_DEGREE");?>");
					dijit.byId("degree").focus();
					return false;
				}
				loadingBlock();
				return true;
			}else {
				return false;
			}
			</script>
			<div class="card-box">
               	<div class="col-sm-12 border-botom">
		    		<div class="col-sm-8 pd-0">
		    			<h4 class="m-b-0"><i class="fa fa-user-plus" aria-hidden="true"></i>&nbsp;&nbsp;&nbsp;<?php echo $tr->translate('CREATE_TO_STUDENT_TEST');?></h4>
	    			</div>
	    			<div class="col-sm-4 text-right">
	    			</div>
	    		</div>
	    	</div>
	    	<div class="card-box">
	        	<div class="col-md-4 col-sm-4 col-xs-12">
					<div class="form-group">
	                   <label class="control-label col-md-12 col-sm-12 col-xs-12 title-blog bold" for="first-name"><i class="fa fa-hand-o-right" aria-hidden="true"></i> <?php echo $tr->translate("STUDENT_INFO");?> 
	                   </label>
	                </div>
	               
	                <div class="form-group">
	                   <label class="control-label bold col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("BRANCH_NAME");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("branch_id");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("STUDENT_ID");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("stu_code");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("SERIAL");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("serial");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label bold col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("STUDENT_NAMEKHMER");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("kh_name");?>
	                   		<?php echo $frm->getElement("id");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label bold col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("First Name");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("first_name");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label bold col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("Last Name");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("en_name");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("SEX");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("sex");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("NATIONALITY");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("nationality");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("NATION");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("nation");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("DOB");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("dob");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("POB");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("pob");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("PHONE");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("phone");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("EMAIL");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("email");?>
	                   </div>
	                </div>
	             </div>
	             <div class="col-md-4 col-sm-4 col-xs-12">
					<div class="form-group">
	                   <label class="control-label col-md-12 col-sm-12 col-xs-12 title-blog bold" for="first-name"><i class="fa fa-hand-o-right" aria-hidden="true"></i> <?php echo $tr->translate("STUDENT_INFO");?> 
	                   </label>
	                </div>
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("STUDENT_STATUS");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("student_status");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("IF_EMPLOYED_WHERE");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("if_employed_where");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("POSITION");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("position");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("PARENT_NAME");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("parent_name");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("PARENT_TEL");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("parent_tel");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("OLD_SCHOOL");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("old_school");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("OLD_GRADE");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("old_grade");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("ADDRESS");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("address");?>
	                   </div>
	                </div>
	             </div>
	             <div class="col-md-4 col-sm-4 col-xs-12">
					<div class="form-group">
	                   <label class="control-label col-md-12 col-sm-12 col-xs-12 title-blog bold" for="first-name"><i class="fa fa-hand-o-right" aria-hidden="true"></i> <?php echo $tr->translate("STUDENT_TEST_INFORMATION");?> 
	                   </label>
	                </div>
	                <div class="form-group">
	                   <div class="col-md-12 col-sm-12 col-xs-12">
	                   		<div class="account-image">
								<div class="image-box">
									<img id="profile_wiew" src="<?php echo $this->baseUrl().'/images/no-profile.png';?>" alt=""  />
								</div>
								<div class="button_browse">
								<div id='preview'></div>	
										<span>Upload <span ><i class="fa fa-camera" aria-hidden="true"></i></span></span>
										<input class="btn_borwse_image" type="file" id="photo" name="photo"  />
										<input type="hidden" name="uploaded" id="uploaded" />
								</div>
							</div>
	                   </div>
	                </div>
	               <!-- 
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php //echo $tr->translate("DEGREE");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php //echo $frm->getElement("degree");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label bold col-md-5 col-sm-5 col-xs-12" for="first-name"><?php //echo $tr->translate("GRADE")?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<input input id="grade" />
	                   </div>
	                </div>
	                
	                <div class="form-group">
	                   <label class="control-label  col-md-5 col-sm-5 col-xs-12" for="first-name"><?php //echo $tr->translate("SESSION")?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php //echo $frm->getElement("session");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label  col-md-5 col-sm-5 col-xs-12" for="first-name"><?php //echo $tr->translate("TIME")?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<select required="false" name="time" id="time" class="fullside" dojoType="dijit.form.FilteringSelect" >
								<option value=""><?php //echo $tr->translate("SELECT_TIME")?></option>
								<option value="7:30-11:00 am">7:30-11:00 am</option>
								<option value="7:30-11:30 am">7:30-11:30 am</option>
								<option value="8:00-9:30 am">8:00-9:30 am</option>
								<option value="8:00-11:00 am">8:00-11:00 am</option>
								<option value="9:30-11:00 am">9:30-11:00 am</option>
								<option value="1:00-4:00 pm">1:00-4:00 pm</option>
								<option value="1:30-6:30 pm">1:30-6:30 pm</option>
								<option value="2:00-3:30 pm">2:00-3:30 pm</option>
								<option value="2:00-5:00 pm">2:00-5:00 pm</option>
								<option value="3:30-5:00 pm">3:30-5:00 pm</option>
								<option value="5:30-7:00 pm">5:30-7:00 pm</option>
								<option value="5:30-8:30 pm">5:30-8:30 pm</option>
								<option value="7:30-8:30 pm">7:30-8:30 pm</option>												
							</select>	
	                   </div>
	                </div>
	                -->
	             </div>
	        </div>
	        <div class="card-box">
               	
	    	</div>
	    	<div class="card-box">
	    		<div class="col-md-12 col-sm-12 col-xs-12">
					
	            </div>
	        	<div class="col-md-4 col-sm-4 col-xs-12">
	        		<div class="col-sm-12 border-botom">
			    		<div class="col-sm-12 pd-0">
			    			<h4 class="m-b-0"><i class="fa fa-volume-control-phone" aria-hidden="true"></i>&nbsp;&nbsp;&nbsp;<?php echo $tr->translate('EMERGENCY_CONTACT');?></h4>
		    			</div>
		    		</div>
		    		<div class="form-group">
	                   <label style="  white-space: normal;  font-style: italic;" class="control-label col-md-12 col-sm-12 col-xs-12 " for="first-name"> 
	                   List any person whom you would like to be contacted in case of emergency.
	                   </label>
	                </div>
	        		<div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("NAME");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("emergency_name");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("RELATIONSHIP_TO_STUDENT");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("relationship_to_student");?>
	                   </div>
	                </div>
	                <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("PHONE");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("emergency_tel");?>
	                   </div>
	                </div>
	                
	                 <div class="form-group">
	                   <label class="control-label col-md-5 col-sm-5 col-xs-12" for="first-name"><?php echo $tr->translate("ADDRESS");?> :
	                   </label>
	                   <div class="col-md-7 col-sm-7 col-xs-12">
	                   		<?php echo $frm->getElement("emergency_address");?>
	                   </div>
	                </div>
	            </div>
	            <div class="col-md-8 col-sm-8 col-xs-12">
	            	<div class="col-sm-12 border-botom">
			    		<div class="col-sm-12 pd-0">
			    			<h4 class="m-b-0"><i class="fa fa-graduation-cap" aria-hidden="true"></i>&nbsp;&nbsp;&nbsp;<?php echo $tr->translate("EDUCATIONAL_BACKGROUND")?>(SchoolName , Grade/Level/Year , Major , Year)</h4>
		    			</div>
		    		</div>
	            	<div class="form-group">
	                   <div class="col-md-12 col-sm-12 col-xs-12">
	                   		<table class="collape tablesorter" id="table_row" style="white-space: nowrap;border:1px solid #ddd;width: 100%;">
						    	<tr id="head-title" class="head-td" align="right"></tr>
							</table>
							<input type="button" label="<?php echo $tr->translate('ADD_ROW');?>" dojoType="dijit.form.Button" 
								iconClass="dijitIconEditProperty" onclick="addRow();" />
							<input type="hidden" name="identity" id="identity" dojoType="dijit.form.TextBox" value="" >
	                   </div>
	                </div>
	            </div>
	       </div>
	        <div class="card-box">
               	<div class="col-sm-12 border-top mt-20 ptb-10 text-center">
               			<input type="reset" label="<?php echo $tr->translate("CLEAR")?>" dojoType="dijit.form.Button"
					 iconClass="dijitIconClear"/>
					<input label="<?php echo $tr->translate("SAVE_CLOSE")?>" name='saveclose' id='saveclose' value='saveclose' dojoType="dijit.form.Button" type="submit"  iconClass="dijitEditorIcon dijitEditorIconSave"/>
					<input label="<?php echo $tr->translate("SAVE_NEW")?>" name='savenew' id='savenew' value='savenew' dojoType="dijit.form.Button" type="submit" iconClass="dijitEditorIcon dijitEditorIconSave"/>
	    		</div>
	    	</div>
		</form>
	</div>
</div>
<div class="dijitHidden">
	<div data-dojo-type="dijit.Dialog" data-dojo-props="title:'<?php echo $tr->translate("ADD_NATION")?>'" style="width:500px;" id="popup_nation" >
		<form  id='frm_nation_kh' dojoType="dijit.form.Form" method="post" enctype="application/x-www-form-urlencoded">
			<table cellspacing="10" width="100%" style="margin: 0 auto;">
				<tr>
					<td>
						<fieldset >
						<legend class="bold" align="center" ><?php echo $tr->translate('ADD_NATION');?></legend>
							<table style="margin: 0 auto; width: 100%;  padding:10px;" cellspacing="10" >
								<tr>
								<td><?php echo $tr->translate('KH_NAME');?></td>
								<td><input dojoType="dijit.form.ValidationTextBox" required="true"  class="fullside" id="title_kh" name="title_kh" value="" type="text"></td>
							</tr>
							<tr>
								<td><?php echo $tr->translate('EN_NAME');?></td>
								<td>
									<input dojoType="dijit.form.ValidationTextBox" required="true"  class="fullside" id="title_en" name="title_en" value="" type="text">
									<input type="hidden" id="status_na" name="status_na" value="1" />
									<input type="hidden" id="indexkey" name="indexkey" value="1" />
								</td>
							</tr>
								<tr>
									<td colspan="4" align="center">
										<input type="button" value="ចាកចេញ" label="<?php echo $tr->translate('CLOSE');?>" id="hide_nation" name="hide_nation" dojoType="dijit.form.Button" 
										​ ​​iconClass="dijitIconUndo" onclick="dijit.byId('popup_nation').hide();"/>
										<input type="button" value="save" label="<?php echo $tr->translate('SAVE');?>" id="save_nation" name="save_nation" dojoType="dijit.form.Button" 
										 iconClass="dijitEditorIcon dijitEditorIconSave" onclick="addNationBy();"/>
									</td>
								</tr>
							</table>
						</fieldset>
					</td>
				</tr>
			</table>
		</form>
	</div>
</div>		
<script type="text/javascript">
function readURL(input) {
    if (input.files && input.files[0]) {
        var reader = new FileReader();
        
        reader.onload = function (e) {
            $('#profile_wiew').attr('src', e.target.result);
        }
        reader.readAsDataURL(input.files[0]);
    }
}
var maxSize = 0;
$("#photo").change(function(){
    readURL(this);
});

var url_getserial = '<?php echo $this->url(array('module'=>'registrar','controller'=>'studenttest','action'=>'getserial')); ?>';
function getSerailCodeByBranch(){
	branch_id = dijit.byId('branch_id').get('value');
	if(branch_id==''){
		return false;
	}
	dojo.xhrPost({
		url: url_getserial,
		content:{
			'branch_id':branch_id
			},
		handleAs:"json",
		load: function(data) {
			alert(data);
			dijit.byId('serial').set('value',data);
		},
		error: function(err) {
			alert(err);
		}
	});
}
require(["dojo/ready"], function(ready){
	
	new dijit.form.FilteringSelect({
		name: "nationality",
		id: "nationality",
		searchAttr: "name",
		class: 'fullside',
		onChange: function() {
			popupNation(1);
	    }
		}, "nationality");
	new dijit.form.FilteringSelect({
		name: "nation",
		id: "nation",
		searchAttr: "name",
		class: 'fullside',
		onChange: function() {
			popupNation(2);
	    }
		}, "nation");
});
function popupNation(key){
	if(key==1){
		var nation = dijit.byId('nationality').get('value');
		$("#indexkey").val(key);
	}else{
		var nation = dijit.byId('nation').get('value');
		$("#indexkey").val(key);
	}
	if(nation==''){
		return false;
	}
	if(nation==-1){
		dijit.byId("popup_nation").show();
	}
}
var nation_store  = getDataStorefromJSON('id','name',<?php print_r(Zend_Json::encode($this->nation));?> );
var url_add_nation = '<?php echo $this->url(array("module"=>"foundation","controller"=>"register","action"=>"add-nation")); ?>';
function addNationBy(){
	if(dijit.byId('frm_nation_kh').validate()){
		loadingBlock();	
		dojo.xhrPost({
			url:url_add_nation,
			form: dojo.byId("frm_nation_kh"),
			handleAs:"json",
			load: function(data) {
				var indexkey = $("#indexkey").val();
					var Itemmake = { 
						 id: data,
						 name: dijit.byId('title_kh').get('value')
					   };
				   if(indexkey==1){
					   addDataToSelectbox(dijit.byId('nationality'), nation_store, Itemmake, data);
					  	nation =  dijit.byId('nation').get('value');
					   dijit.byId('nation').set('store', nation_store);
					   if(nation!=""){
					   dijit.byId('nation').set('value', nation);
					   }
				   }else{	   
				   	  addDataToSelectbox(dijit.byId('nation'), nation_store, Itemmake, data);
					  dijit.byId('nationality').set('store', nation_store);
					  nation =  dijit.byId('nationality').get('value');
					  if(nation!=""){
					  dijit.byId('nationality').set('value', nation);
					  }
				   }
				   dijit.byId('frm_nation_kh').reset();
				   dijit.byId("popup_nation").hide();
				   HideloadingBlock();
			},
			error: function(err) {
				alert(err);
			}
		});
	}
}
	/*
		dojo.require("dojo.data.ItemFileWriteStore");  
		var grade_store  = getDataStorefromJSON('id','name', <?php //print_r(Zend_Json::encode($this->dept));?> );
		
		dojo.ready(function(){
			new dijit.form.FilteringSelect({
				store: grade_store,
				autoComplete: true,                        
				required: false,
				id: "grade",
				name: "grade",           
				class: "fullside", 
				placeHolder:"Select grade",          
				onChange: function() {  
					
				}
			}, "grade");
			
			getAllGrade();				 
		});
		
		var url_get_grade = '<?php //echo $this->url(array('module'=>'registrar','controller'=>'register','action'=>'get-grade')); ?>';
		function getAllGrade(){
			dijit.byId('grade').set('value',''); 
			dept_id = dijit.byId('degree').get('value');
			if(dept_id==''){
				return false;
			}
			dojo.xhrPost({
				url:url_get_grade,
				content:{
					'dept_id':dept_id
					},
				handleAs:"json",
				load: function(data) {
					grade_store  = getDataStorefromJSON('id','name', data);
					dijit.byId('grade').set('store',grade_store);  
				},
				error: function(err) {
					alert(err);
				}
			});
		}
 
	*/
</script>
 
 <script>
 dojo.require("dojo.data.ItemFileWriteStore");  
 dojo.require("dojo.NodeList-manipulate");
	dojo.ready(function(){ 
		addRow();
	});

	var col= 0; var no=0;
	var title = 0;
	var all_stu = '<?php //echo $this->all_stu; ?>';
	function addRow() {
		col++;no++;
		template='';
		temp = "";
	
		if(title!=1){
			temp+='<td><?php echo $tr->translate("DEL");?></td>';
			temp+='<td><?php echo $tr->translate("N_O");?></td>';
			temp+='<td><?php echo $tr->translate("SCHOOL_AND_NAME");?></td>';
			temp+='<td><?php echo $tr->translate("GRADE_LAVEL");?></td>';
			temp+='<td><?php echo $tr->translate("YEAR");?></td>';
			temp+='<td><?php echo $tr->translate("MAJOR");?></td>';
			temp+='<td><?php echo $tr->translate("NOTE");?></td>';
			dojo.query("#head-title").append(temp);
			title=1;
		}
			
		template+='<td width="2%" align="center"><img onclick="deleteRecord('+col+');" src="<?php echo $this->baseUrl();?>/images/Delete_16.png"></td>';
		template+='<td align="center" width="2%">'+no+'</td>';
		template+='<td width="10%"><input dojoType="dijit.form.ValidationTextBox" class="fullside" required="required" id="school_name'+col+'" name="school_name'+col+'" value="" type="text"  ></td>';	
		template+='<td width="10%"><input dojoType="dijit.form.ValidationTextBox" class="fullside" id="level'+col+'" name="level'+col+'" value="" type="text"  ></td>';	
		template+='<td width="10%"><input dojoType="dijit.form.ValidationTextBox" class="fullside" id="year'+col+'" name="year'+col+'" value="" type="text"  ></td>';	
		template+='<td width="10%"><input dojoType="dijit.form.ValidationTextBox" class="fullside" id="major'+col+'" name="major'+col+'" value="" type="text"  ></td>';	
		template+='<td width="10%"><input dojoType="dijit.form.ValidationTextBox" class="fullside" id="remark_'+col+'" name="remark_'+col+'" value="" type="text"  ></td>';	
		tmp='<tr id="row'+col+'">';
		tmp+="</tr>";
		dojo.query("#table_row").append(tmp);
		if($("#identity").val()!="") {
			var identity = $("#identity").val();
			$("#identity").val(identity+','+col);
		} else {$("#identity").val(col);}
		dojo.html.set(dojo.byId("row"+col),template , {
		     parseContent: true,
		});
	}
	function deleteRecord(index) {
		var identity = $('#identity').val();
		var arrays = identity.split(',');
		for(var i=0;i<arrays.length;i++) {
		
		if(arrays[i] == index) arrays.splice(i,1);
			
		}
		var strings = arrays.join(',');
		$('#identity').val(strings);
		dojo.query("#row"+index).remove();
	}
</script>
 